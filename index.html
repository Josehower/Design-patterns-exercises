<!DOCTYPE html>
<html>

<head>
</head>

<body>

  <h1>Maze Creator</h1>


  <script>
    class MapSite {
      constructor() {
        if (this.constructor === MapSite) {
          throw 'this is an Abstrct Class';
        }
      }

      enter() {
        throw 'this method need to be implemented on each subClass';
      }
    }

    class Room extends MapSite {
      constructor() {
        super();
        this.name = `room${Room.prototype.conteo}`;
        this.roomNumber = Room.prototype.conteo;
        this.structure = {};
        console.log(`creating room number ${this.roomNumber}`);
        Room.prototype.conteo++;
      }

      enter() {
        console.log(`your are now on room number ${this.roomNumber}`);
      }

      setSide(direction, MapSiteComponent) {
        if (
          !(
            direction === 'N' ||
            direction === 'S' ||
            direction === 'E' ||
            direction === 'W'
          )
        ) {
          throw 'you have to set a real direction N, S, E, or W';
        } else {
          this.structure[direction] = MapSiteComponent;
        }
      }

      getSide(direction) {
        if (
          !(
            direction === 'N' ||
            direction === 'S' ||
            direction === 'E' ||
            direction === 'W'
          )
        ) {
          throw 'you have to set a real direction N, S, E, or W';
        } else if (this[direction]) {
          console.log(this[direction].name);
        } else {
          console.log('nothing There');
        }
      }
    }

    Room.prototype.conteo = 1;

    class RoomWithBomb extends Room {
      constructor() {
        super();
        this.name = `Bombed room${this.roomNumber}`;
        this.inside = 'bomb';
      }
    }

    class Wall extends MapSite {
      constructor() {
        super();
        this.name = `Wall${Wall.prototype.conteo} `;
        this.wallNumber = Wall.prototype.conteo;
        console.log(`creating wall number ${this.wallNumber} `);
        Wall.prototype.conteo++;
      }
    }
    Wall.prototype.conteo = 1;

    class BombedWall extends Wall {
      constructor() {
        super();
        this.name = `Bombed wall${this.wallNumber} `;
      }

      explodeBomb() {
        console.log('kahboom...');
      }
    }

    class Door extends MapSite {
      constructor(roomA, roomB) {
        super();
        if (!(roomA && roomB)) {
          throw 'need two rooms';
        }

        this.name = `Door${Door.prototype.conteo} `;
        this.doorNumber = Door.prototype.conteo;
        this.between = [roomA.name, roomB.name];
        console.log(
          `creating door # ${this.doorNumber} between ${this.between[0]} and ${this.between[1]} `
        );
        Door.prototype.conteo++;
      }
    }
    Door.prototype.conteo = 1;

    class Maze {
      constructor() {
        console.log(`creating a new Maze`);
        this.rooms = [];
      }

      addRoom(room) {
        this.rooms.push(room);
      }

      /* TODO: create search RoomNo. method */
    }

    class MazeGame {
      constructor() {
        console.log(`creating a new MazeGame`);
      }

      makeMaze() {
        return new Maze();
      }

      makeRoom() {
        return new Room();
      }

      makeWall() {
        return new Wall();
      }

      makeDoor(r1, r2) {
        return new Door(r1, r2);
      }

      createMaze() {
        const oneMaze = this.makeMaze();
        const r1 = this.makeRoom();
        const r2 = this.makeRoom();
        const theDoor = this.makeDoor(r1, r2);
        oneMaze.addRoom(r1);
        oneMaze.addRoom(r2);

        r1.setSide('N', this.makeWall());
        r1.setSide('E', theDoor);
        r1.setSide('S', this.makeWall());
        r1.setSide('W', this.makeWall());

        r2.setSide('N', this.makeWall());
        r2.setSide('E', this.makeWall());
        r2.setSide('S', this.makeWall());
        r2.setSide('W', theDoor);
        return oneMaze;
      }
    }

    class BombedMazeGame extends MazeGame {
      constructor() {
        super();
        console.log(`creating a new Bombed Maze Game`);
      }

      makeWall() {
        return new BombedWall();
      }

      makeRoom() {
        return new RoomWithBomb();
      }
    }

    myMaze = new MazeGame().createMaze();
    console.log(myMaze);
    myBombedMaze = new BombedMazeGame().createMaze();
    console.log(myBombedMaze);
  </script>
</body>

</html>